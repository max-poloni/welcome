<!DOCTYPE html>
<html lang="ru">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8T173410KK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-8T173410KK');
  </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</title>
  <link rel="stylesheet" href="styless-main.css">
  <link rel="icon" href="default_favicon.ico" type="image/x-icon">

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –Ω–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã -->
  <script src="scripts/firebase-config.js"></script>
  <script src="scripts/user.js"></script>
  <script src="scripts/games.js"></script>
  <script src="scripts/modals.js"></script>

  <script>
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    function checkAuth() {
      const currentUser = localStorage.getItem('currentUser');
      if (currentUser) {
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –±–∞–∑—ã
        firebase.database().ref('users/' + currentUser).once('value').then((snapshot) => {
          if (snapshot.exists()) {
            const userData = snapshot.val();
            document.getElementById('username').innerText = `Username: ${userData.username}`;
            document.getElementById('balance').innerText = `–ë–∞–ª–∞–Ω—Å: ${userData.balance} üç∫`;
          } else {
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.');
          }
        }).catch((error) => {
          console.error('–û—à–∏–±–∫–∞:', error);
        });
      } else {
        // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º
        document.getElementById('username').innerText = 'Username: –ì–æ—Å—Ç—å';
        document.getElementById('balance').innerText = '–ë–∞–ª–∞–Ω—Å: 0 üç∫';
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —á–∏—Å–ª–∞ –æ—Ç min –¥–æ max
    function getRandomUserCount(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    function loadUserData() {
      return new Promise((resolve) => {
        const userCount = getRandomUserCount(300, 777); // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç 300 –¥–æ 777
        document.getElementById('userCount').innerText = `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: ${userCount}`;
        resolve();
      });
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
    function openDepositModal() {
      const currentUser = localStorage.getItem('currentUser');
      if (currentUser) {
        document.getElementById('paymentModal').style.display = 'block';
      } else {
        alert('–î–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç.');
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
    function closePaymentModal() {
      document.getElementById('paymentModal').style.display = 'none';
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ –∫–æ—à–µ–ª—å–∫–∞
    function displayWalletAddress() {
      const walletInfo = document.getElementById('walletInfo');
      walletInfo.style.display = 'block'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ—à–µ–ª—å–∫–µ
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã
    function confirmPayment() {
      const amount = document.getElementById('amount').value;
      const currentUser = localStorage.getItem('currentUser');

      if (amount && currentUser) {
        // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤ Firebase
        const paymentData = {
          user: currentUser,
          amount: parseFloat(amount),
          status: 'pending', // –°—Ç–∞—Ç—É—Å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è (–æ–∂–∏–¥–∞–Ω–∏–µ)
          timestamp: new Date().toISOString()
        };

        // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤ –±–∞–∑—É
        firebase.database().ref('deposits/' + currentUser).push(paymentData)
                .then(() => {
                  alert(`–ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ —Å—É–º–º—É ${amount} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω. –û–∂–∏–¥–∞–π—Ç–µ.`);
                  closePaymentModal(); // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
                })
                .catch((error) => {
                  console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:', error);
                  alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
                });
      } else if (!currentUser) {
        alert('–î–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç.');
      } else {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è.');
      }
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
    window.onload = function () {
      checkAuth(); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      loadUserData() // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
              .then(() => {
                console.log('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞–≥—Ä—É–∂–µ–Ω—ã.');
              })
              .catch((error) => {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', error);
              });
      loadGames(); // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–≥—Ä—ã
    };
  </script>
</head>
<body>
<header>
  <h1>Games</h1>
  <div id="username">Username: –ì–æ—Å—Ç—å</div>
  <div id="balance">–ë–∞–ª–∞–Ω—Å: 0 üç∫</div>
  <div id="userCount">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: 0</div> <!-- –°—á—ë—Ç—á–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
  <button onclick="openDepositModal()" style="float: right; margin: 10px;">–î–µ–ø</button>
</header>
<main>
  <div class="slider">
    <div class="game" id="game1">
      <img src="game1.jpg" alt="–ò–≥—Ä–∞ 1">
      <div class="game-users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: 0</div> <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∏–≥—Ä—ã 1 -->
    </div>
    <div class="game" id="game2">
      <img src="game2.jpg" alt="–ò–≥—Ä–∞ 2">
      <div class="game-users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: 0</div> <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∏–≥—Ä—ã 2 -->
    </div>
    <div class="game" id="game3">
      <img src="game3.jpg" alt="–ò–≥—Ä–∞ 3">
      <div class="game-users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: 0</div> <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∏–≥—Ä—ã 3 -->
    </div>
    <div class="game" id="game4">
      <img src="game4.jpg" alt="–ò–≥—Ä–∞ 4">
      <div class="game-users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: 0</div> <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∏–≥—Ä—ã 4 -->
    </div>
    <div class="game" id="game5">
      <img src="game5.jpg" alt="–ò–≥—Ä–∞ 5">
      <div class="game-users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: 0</div> <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∏–≥—Ä—ã 5 -->
    </div>
  </div>
</main>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é –±–∞–ª–∞–Ω—Å–∞ -->
<div id="paymentModal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close" onclick="closePaymentModal()">&times;</span>
    <h2>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞</h2>
    <label for="amount">–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è:</label>
    <input type="number" id="amount" placeholder="–°—É–º–º–∞" />
    <button onclick="displayWalletAddress()">–í–Ω–µ—Å—Ç–∏</button>

    <div id="walletInfo" style="display:none;">
      <p>–ê–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞ TRC20 USDT:</p>
      <p id="walletAddress">TXYZ1234567890ABCDEFGH</p>
      <button onclick="confirmPayment()">–Ø –æ–ø–ª–∞—Ç–∏–ª</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–≥—Ä -->
<div id="gameModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeGameModal()">&times;</span>
    <div id="modalContent"></div>
  </div>
</div>

</body>
</html>
